# ***Final Project: Optimal Hedging with Advanced Greeks***



## Part 1: Simple Volatility Arbitrage but improved Asset Evolution

1. Monte Carlo simulation is a technique for approximating the solution of a mathematical problem by using random sampling. For example, to estimate the value of an integral, one can sample points from the domain of integration and compute the average value of the integrand at those points. The accuracy of the approximation depends on the number and quality of the random samples.

Pseudo-random numbers are numbers that are generated by a deterministic algorithm, but appear to be random and uniformly distributed. They are commonly used in Monte Carlo simulation because they are easy to produce and have good statistical properties. However, pseudo-random numbers have some drawbacks, such as periodicity, correlation and clustering. Periodicity means that the sequence of pseudo-random numbers will eventually repeat itself. Correlation means that some pairs of pseudo-random numbers are more likely to occur than others. Clustering means that some regions of the domain are more densely sampled than others.

Quasi-random numbers are numbers that are generated by a deterministic algorithm, but are designed to be more evenly distributed than pseudo-random numbers. They are also called low-discrepancy sequences, because they have a low measure of discrepancy, which is a way of quantifying how uniformly a set of points covers a domain. Quasi-random numbers are often used in Monte Carlo simulation because they can achieve faster convergence and better accuracy than pseudo-random numbers. However, quasi-random numbers have some challenges, such as complexity, dimensionality and dependence. Complexity means that the algorithm for generating quasi-random numbers is more complicated than that for pseudo-random numbers. Dimensionality means that the quality of quasi-random numbers deteriorates as the dimension of the problem increases. Dependence means that quasi-random numbers are not independent from each other, which can affect some statistical tests.

Mathematically, pseudo-random numbers and quasi-random numbers can be defined as follows:

- A pseudo-random number generator (PRNG) is a function that maps a seed (an initial value) to an infinite sequence of numbers in the interval $[0,1]$. A PRNG has two properties: uniformity and unpredictability. Uniformity means that the probability of any number in $[0,1]$ occurring in the sequence is equal to 1. Unpredictability means that given any part of the sequence, it is impossible to determine the next number without knowing the seed or the algorithm.
    
- A quasi-random number generator (QRNG) is a function that maps an index (a natural number) to a finite or infinite sequence of numbers in the interval $[0,1]$. A QRNG has one property: low-discrepancy. Low-discrepancy means that for any subinterval $[a,b]$ of $[0,1]$, the proportion of numbers in the sequence that fall in $[a,b]$ is close to b-a.
    

One way to measure the discrepancy of a sequence is by using the star discrepancy, which is defined as follows:

$$D_N^* = \sup_{0 \leq a \leq b \leq 1} \left| \frac{A([a,b])}{N} - (b-a) \right|$$


where $N$ is the length of the sequence, $A([a,b])$ is the number of elements in the sequence that fall in $[a,b]$, and sup⁡ denotes the supremum (the least upper bound).

The star discrepancy measures how far the empirical distribution of the sequence deviates from the uniform distribution. The lower the star discrepancy, the more evenly distributed the sequence is.

Some examples of PRNGs are linear congruential generators (LCGs), Mersenne Twister (MT), and Blum Blum Shub (BBS). Some examples of QRNGs are Halton sequence, Sobol sequence, and Niederreiter sequence.


2. Volatility arbitrage is a trading strategy that exploits the difference between the implied volatility of an option and the forecasted or realized volatility of the underlying asset. A delta-neutral portfolio consists of an option and its underlying asset, such that the net exposure to the price movement of the asset is zero. The profit and loss of a delta-neutral portfolio depends on the changes in the option's implied volatility and the underlying asset's realized volatility over time. 

If we assume that $\sigma_a​>\sigma_i$​, then the first term on the right-hand side of the P&L formula is positive, meaning that the option holder benefits from the higher realized volatility than implied. The second term is negative, representing the time decay of the option. Therefore, the net P&L depends on the relative magnitude of these two terms.

To confirm the $P\&L$ of a delta-neutral portfolio under a known future realized volatility, we need to use the Black-Merton-Scholes (BMS) option pricing formula and its partial derivatives, also known as the Greeks. The BMS formula gives the theoretical value of an option as a function of the underlying asset price, $S$, the strike price, $K$, the time to maturity, $T$, the risk-free interest rate, $r$, and the implied volatility, $\sigma$. The Greeks measure the sensitivity of the option value to various factors, such as delta ($\Delta$), which measures the change in option value with respect to the change in underlying asset price; gamma ($\Gamma$), which measures the change in delta with respect to the change in underlying asset price; theta ($\Theta$), which measures the change in option value with respect to the change in time; and Vega ($V$), which measures the change in option value with respect to the change in implied volatility. 

$$C(St​,t)=St​N(d1​)−Ke−r(T−t)N(d2​)$$

$$\Gamma_{t}​=\dfrac{N'(d1​)}{S_{t}\sigma_{i}\sqrt{T-t}​​}$$

$$
\theta_t=-\frac{S_t \sigma_i N^{\prime}\left(d_1\right)}{2 \sqrt{T-t}}-r K e^{-r(T-t)} N\left(d_2\right)
$$


where $r$ is the risk-free rate, $N$ is the standard normal cumulative distribution function, $N'$ is its derivative (the standard normal density function), and

$$
d_1=\frac{\ln \left(S_t / K\right)+\left(r+\sigma_i^2 / 2\right)(T-t)}{\sigma_i \sqrt{T-t}}
$$
$$
d_2=d_1-\sigma_i \sqrt{T-t}
$$

The $P\&L$ of a delta-neutral portfolio can be approximated by a Taylor series expansion of the BMS formula around the initial values of the underlying asset price, $S_0$, and the implied volatility, $\sigma_0$. Assuming that we hold one unit of option and $-\Delta$ units of underlying asset, we can write: $$P\&L_t \approx \frac{1}{2} \Gamma S_0^2 (\sigma_t^2 - \sigma_0^2) + V (\sigma_t - \sigma_0) + \Theta t$$where $\sigma_t$ is the realized volatility of the underlying asset over time $t$, and $\sigma_0$ is the initial implied volatility of the option. The first term on the right-hand side represents the gamma $P\&L$, which captures the convexity effect of the option value with respect to changes in underlying asset price. The second term represents the Vega $P\&L$, which captures the sensitivity of the option value with respect to changes in implied volatility. The third term represents the theta $P\&L$, which captures the time decay effect of the option value. 

If we know the future realized volatility, $\sigma_T$, at maturity $T$, we can compute the total $P\&L$ of a delta-neutral portfolio by integrating over time:$$P\&L_T = \int_0^T P\&L_t dt \approx \frac{1}{2} \Gamma S_0^2 (\sigma_T^2 - \sigma_0^2) T + V (\sigma_T - \sigma_0) T - \int_0^T \Theta dt$$ where $\int_0^T \Theta dt$ is the cumulative theta decay over time. This formula shows that if we hedge at the true future realized volatility, $\sigma_T$, our $P\&L$ will be deterministic and guaranteed. However, if we hedge at a different level of implied volatility, $\sigma_t$, our $P\&L$ will be stochastic and uncertain. 

We can show that actual volatility hedging lead to know P&L by doing the following:

recall the formula above where Γ, V, and Θ are the Greeks of the option value, $S_{0}$ is the initial underlying asset price, $\sigma t$ is the realized volatility of the underlying asset over time $t$, $\sigma_{0}$ is
the initial implied volatility of the option, and $\sigma_{T}$ is the true future realized volatility at maturity $T$.

If we hedge at the actual volatility, then $\sigma_{t} = \sigma_{T}$ for all $t$. This means that the $P\&L$ of a delta-neutral portfolio is deterministic and equal to:

$$P\&L_T = \frac{1}{2} \Gamma S_0^2 (\sigma_T^2 - \sigma_0^2) T + V (\sigma_T - \sigma_0) T - \int_0^T \Theta dt$$

This formula shows that if we hedge at the actual volatility, our P&L will be known and guaranteed. Therefore, actual volatility hedging leads to the known total P&L.

We can also show mathematically that if we hedge at a different level of implied volatility, σt, our P&L will be stochastic and uncertain. For this we need to use the concept of variance and covariance of random variables. Variance measures the dispersion or variability of a random variable around its mean, while covariance measures the joint variability or correlation of two random variables.

Recall that we have the following expression for the P&L of a delta-neutral portfolio:

$$P\&L_t \approx \frac{1}{2} \Gamma S_0^2 (\sigma_t^2 - \sigma_0^2) + V (\sigma_t - \sigma_0) + \Theta t$$

If we hedge at a different level of implied volatility, $\sigma_{t}$, then $\sigma_{t}$ is not equal to $\sigma_{T}$, where $\sigma_{T}$ is the true future realized volatility at maturity $T$. Therefore, $\sigma_{t}$ is a random variable that depends on the stochastic process of the underlying asset price. This means that the $P\&L$ of a delta-neutral portfolio is also a random variable that has some variance and covariance with other factors.

To calculate the variance of $P\&L$, we need to use the following formula:

$$Var(P\&L_t) = E[(P\&L_t - E[P\&L_t])^2]$$

where$E[.]$ denotes the expectation operator. This formula gives us the average squared deviation of $P\&L$ from its mean value.

To calculate the covariance of $P\&L$ with another random variable $X$, we need to use the following formula:

$$Cov(P\&L_t,X) = E[(P\&L_t - E[P\&L_t])(X - E[X])]$$

This formula gives us the average product of the deviations of $P\&L$ and $X$ from their mean values.

Using these formulas, we can show that if we hedge at a different level of implied volatility, $\sigma_{t}$, our $P\&L$ will have some non-zero variance and covariance with other factors, such as $S$ and $\sigma$. For example, we can show that:

$$Var(P\&L_t) = \frac{1}{4} \Gamma^2 S_0^4 Var(\sigma_t^2) + V^2 Var(\sigma_t) + 2 \frac{1}{2} \Gamma S_0^2 V Cov(\sigma_t^2,\sigma_t)$$
$$Cov(P\&L_t,S) = \frac{1}{2} \Gamma S_0^3 Cov(\sigma_t^2,S) + V S Cov(\sigma_t,S)$$
$$Cov(P\&L_t,\sigma) = \frac{1}{2} \Gamma S_0^2 Cov(\sigma_t^2,\sigma) + V Cov(\sigma_t,\sigma)$$

These formulas show that the variance and covariance of $P\&L$ depend on the variance and covariance of $\sigma_{t}$ and $\sigma_{t}^2$ with themselves and with other factors. These terms are generally non-zero and positive, meaning that $P\&L$ has some dispersion and correlation with other factors. Therefore, $P\&L$ is stochastic and uncertain.

***Analytical:*** To confirm this formula analytically, we can use some properties of stochastic calculus and Ito's lemma to derive an expression for $\frac{dP\&L_t}{dt}$ in terms of $\frac{dS_t}{S_t}$ and $\frac{d\sigma_t}{\sigma_t}$, where $S_t$ is the underlying asset price at time $t.$Then we can integrate both sides from 0 to $T$ and compare with our approximation (see below for derivation).
  
Recall that we have the following stochastic differential equations for $S$ and $\sigma$: 
$$\begin{aligned} dS &= \mu S dt + \sigma S dB \\ d\sigma &= \alpha dt + \beta dW \end{aligned}$$where $B$ and $W$ are two independent Wiener processes, and $\mu$, $\alpha$, $\beta$ are some constants. 

Recall that we have the following approximation for the P\&L of a delta-neutral portfolio: 
$$P\&L_t \approx \frac{1}{2} \Gamma S_0^2 (\sigma_t^2 - \sigma_0^2) + V (\sigma_t - \sigma_0) + \Theta t$$

where $\Gamma$, $V$, and $\Theta$ are the Greeks of the option value. 

Apply Ito's lemma to the function $f(t,s,\sigma) = P\&L(t,s,\sigma)$, which gives:

$$df = \frac{\partial f}{\partial t} dt + \frac{\partial f}{\partial s} ds + \frac{\partial f}{\partial \sigma} d\sigma + \frac{1}{2} \frac{\partial^2 f}{\partial s^2} ds^2 + \frac{1}{2} \frac{\partial^2 f}{\partial \sigma^2} d\sigma^2 + \frac{\partial^2 f}{\partial s \partial \sigma} ds d\sigma$$

Substitute the expressions for $ds$, $d\sigma$, $ds^2$, $d\sigma^2$, and $ds d\sigma$ using the stochastic differential equations and the properties of Wiener processes:
$$\begin{aligned} df &= \left( \frac{\partial f}{\partial t} + \mu S \frac{\partial f}{\partial s} + \alpha \frac{\partial f}{\partial \sigma} + \frac{1}{2} (\sigma S)^2 \frac{\partial^2 f}{\partial s^2} + \frac{1}{2} \beta^2 \frac{\partial^2 f}{\partial \sigma^2} + (\sigma S) (\beta) \frac{\partial^2 f}{\partial s \partial \sigma} \right) dt \\ &\quad + (\sigma S) \frac{\partial f}{\partial s} dB + (\beta) \frac{\partial f}{\partial \sigma} dW \end{aligned}$$

Identify the coefficients of $dt$, $dB$, and $dW$ as follows:
$$ \begin{aligned} a(t,s,\sigma) &= \frac{\partial f}{\partial t} + \mu S \frac{\partial f}{\partial s} + (\alpha) \frac{\partial f}{\partial \sigma} + (\frac{1}{2}) (\sigma S)^2 (\frac{\partial^2 f}{\partial s^2}) + (\frac{1}{2}) (\beta)^2 (\frac{\partial^2 f}{\partial \sigma^2}) + (\sigma S) (\beta) (\frac{\partial^2 f}{\partial s \partial \sigma})\end{aligned}$$$$ b(t,s,\sigma)= (\sigma S) (\frac{\partial f}{\partial s})$$

$$c(t,s,\sigma) = (\beta) (\frac{\partial f}{\partial \sigma})$$

Rewrite $df$ as: 
$$df = a(t,s,\sigma) dt + b(t,s,\sigma) dB + c(t,s,\sigma) dW$$

Compare $df$ with $dP\&L$ and equate the coefficients of $dt$, $dB$, and $dW$:

$$dP\&L = a(t,S,\sigma) dt + b(t,S,\sigma) dB + c(t,S,\sigma) dW$$
$$a(t,S,\sigma) = P\&L_t - P\&L_0 = V(\sigma - \sigma_0) + \Theta t + (\frac{1}{2}) \Gamma S_0 (\sigma_t - \sigma_0)^2 T + O(t)$$$$b(t,S,\sigma) = VS$$$$c(t,S,\sigma) = V$$

Divide both sides by $dt$ and rearrange the terms:
$$\frac{dP\&L}{dt} = a(t,S,\sigma) + b(t,S,\sigma) \frac{dB}{dt} + c(t,S,\sigma) \frac{dW}{dt}$$ $$\frac{dP\&L}{dt} = V(\sigma - \sigma_0) + \Theta + (\frac{1}{2}) \Gamma S_0 (\sigma_t - \sigma_0)^2 T + O(t) + V S (\frac{dB}{dt}) + V (\frac{dW}{dt})$$

Recall that $\frac{dB}{dt}$ and $\frac{dW}{dt}$ are both zero in expectation since $B$ and $W$ are Wiener processes. Thus, we can ignore the last two terms and write:

$$\frac{dP\&L}{dt} = V(\sigma - \sigma_0) + \Theta + (\frac{1}{2}) \Gamma S_0 (\sigma_t - \sigma_0)^2 T + O(t)$$

Integrate both sides from 0 to $T$ and take the limit as $t \to 0$: 

$$P\&L_T - P\&L_0 = \int_0^T V(\sigma - \sigma_0) + \Theta + (\frac{1}{2}) \Gamma S_0 (\sigma_t - \sigma_0)^2 dt$$

Compare this with our approximation and see that they are the same, except for the $O(t)$ term, which tends to zero as $t \to 0$. Therefore, we have confirmed our formula analytically.

- To confirm this formula numerically, we can use Monte Carlo simulation to generate random paths for $S_t$ and $\sigma_t$ based on some assumptions about their dynamics and parameters. Then we can apply our approximation to each path and compute its $P\&L$ at maturity. We can compare the average $P\&L$ across all paths with our formula and check if they are close enough.

3. Some additional analysis that can be provided are:

	1. You can decompose the P&L of a delta-hedged option position into three components: the volatility component, the theta component, and the gamma component. The volatility component is the first term on the right-hand side of the P&L formula, which captures the difference between the actual and implied volatility. The theta component is the second term, which represents the time decay of the option. The gamma component is the third term, which arises from the discretization error of delta-hedging and reflects the convexity of the option payoff.
	
	 2. You can examine how the gamma component affects the $P\&L$ over time. The gamma component is proportional to $\Gamma_t S_t^2 \Delta t$, where $\Gamma_t$ is the option gamma, $S_t$ is the underlying price, and $\Delta t$ is the time step. This means that the gamma component is larger when the option is more sensitive to changes in the underlying price (higher gamma), when the underlying price is higher (higher leverage), and when the time step is longer (higher discretization error). Therefore, you can expect the gamma component to be more significant for at-the-money options, for high-priced stocks, and for longer rebalancing intervals.
	 
	 3. The term $r^2 - \sigma_{imp}^2 \delta t$ affects the P&L of a delta-hedged option position by capturing the effects of implied volatility and time decay. As I explained before, a delta-hedged option position has no exposure to changes in the underlying asset price, but it has exposure to changes in implied volatility and time decay. Implied volatility is the market's expectation of the future volatility of the underlying asset, and it affects the option price through vega. Time decay is the reduction in the option price as it approaches expiration, and it affects the option price through theta.

The term $r^2 - \sigma_{imp}^2 \delta t$ can be derived from the formula for the expected return of an option position under the risk-neutral measure:

$$
E[r_{option}] \approx r + \Delta E[r_S] - \frac{1}{2} \Gamma S^2 \sigma_{imp}^2
$$

If we assume that the option position is delta-hedged, then $\Delta = 0$ and $E[r_S] = r$. Therefore, we can simplify the formula as follows:

$$
E[r_{option}] \approx r - \frac{1}{2} \Gamma S^2 \sigma_{imp}^2
$$

Now, if we subtract $r$ from both sides and multiply by $\delta t$, we get:

$$
E[r_{option}] - r \approx - \frac{1}{2} \Gamma S^2 \sigma_{imp}^2 \delta t
$$

This equation shows that the difference between the expected return of a delta-hedged option position and a risk-free investment over a small time interval $\delta t$ is approximately equal to the negative of half of the product of gamma, underlying asset price squared, implied volatility squared, and time interval. This term is what we call $r^2 - \sigma_{imp}^2 \delta t$.

The sign and magnitude of this term depend on the values of gamma, implied volatility, and time interval. Gamma is positive for long option positions and negative for short option positions. Implied volatility and time interval are always positive. Therefore, this term is positive for short option positions and negative for long option positions. The larger the absolute value of gamma, implied volatility, and time interval, the larger the absolute value of this term.

A positive value of this term means that a delta-hedged option position earns more than a risk-free investment over a small time interval $\delta t$. A negative value of this term means that a delta-hedged option position earns less than a risk-free investment over a small time interval $\delta t$. Therefore, this term affects the P&L of a delta-hedged option position by either adding or subtracting from it depending on whether it is positive or negative.

Impact of Time-Dependent Gamma ($\Gamma$) and $r^2 - \sigma_{\text{imp}}^2$ on P&L:

- Time-Dependent Gamma ($\Gamma$): As options approach expiration, gamma tends to increase for at-the-money options and decrease for in-the-money and out-of-the-money options. This means that the impact of underlying price changes on the P&L can be more significant as expiration approaches.

Refer to Part 1 section 1.2 of the jupyter Notebook for the simulations.

## Part 2: Advanced Greeks


1. To numerically compute the adjustment for expected changes in implied volatility as a result of changes in asset price, we need to estimate the partial derivative of the implied volatility with respect to the asset price, or $\frac{\partial E\left(\sigma_{i m p}\right)}{\partial S}$. One way to do this is to use a finite difference approximation, such as:
$$
\frac{\partial E\left(\sigma_{i m p}\right)}{\partial S} \approx \frac{E\left(\sigma_{i m p}(S+\Delta S)\right)-E\left(\sigma_{i m p}(S-\Delta S)\right)}{2 \Delta S}
$$
where $\Delta$ $S$ is a small increment in the asset price. To calculate $E(\sigma_{\mathrm{Im}p}(S))$, we can use an option pricing model, such as Black-Scholes, and invert it to find the implied volatility that matches the market price of the option.

For example, suppose we have a European call option on a non-dividend-paying stock with a strike price of $\$ 50$, a risk-free interest rate of $5 \%$, and 32 days to expiration. The current stock price is $\$ 51.25$ and the market price of the option is $\$ 2.00$. Using a standard Black-Scholes model, we can find that the implied volatility is $18.7 \%$. If we increase the stock price by $\$ 0.01$ to $\$ 51.26$, the market price of the option becomes $\$ 2.01$ and the implied volatility is $18.8 \%$. If we decrease the stock price by $\$ 0.01$ to $\$ 51.24$, the market price of the option becomes $\$ 1.99$ and the implied volatility is $18.6 \%$. Using the finite difference approximation, we can estimate that:
$$
\frac{\partial E\left(\sigma_{i m p}\right)}{\partial S} \approx \frac{0.188-0.186}{2 \times 0.01}=0.1
$$
This means that for every $\$ 1$ increase in the stock price, we expect the implied volatility to increase by $0.1 \%$. To adjust the delta of our option portfolio for this effect, we need to multiply it by $(1+0.1 \%)$ or 1.001.

Under the minimum variance we have the following: 

The minimum variance delta is a measure of the sensitivity of an option value to changes in the underlying asset price, taking into account the negative correlation between the asset price and the implied volatility. It is defined as:

$$\Delta_{MV} = \Delta_{BS} + \frac{\partial E(\sigma_{imp})}{\partial S} V_{BS}$$
And
$$\frac{\partial E(\sigma_{imp})}{\partial S} \approx \frac{\alpha + \beta\delta_{BS} + c\delta^{2}_{BS}}{S \sqrt{T}}$$
where $\Delta_{BS}$ is the Black-Scholes delta, $V_{BS}$ is the Vega, and $E(\sigma_{imp})$ is the expected implied volatility conditional on the asset price.

To numerically compute the adjustment term $\frac{\partial E(\sigma_{imp})}{\partial S}$, we need to estimate the relationship between the implied volatility and the asset price using historical data. One way to do this is to use a linear regression model of the form:

$$\sigma_{imp} = a + b S + \epsilon$$

where $a$ and $b$ are regression coefficients, and $\epsilon$ is a random error term. Then, we can use the estimated values of $a$ and $b$ to calculate the partial derivative as:

$$\frac{\partial E(\sigma_{imp})}{\partial S} = b$$

Another way to do this is to use a non-linear regression model of the form:

$$\sigma_{imp} = f(S) + \epsilon$$
where $f(S) \approx \alpha + \beta S + cS^2$ (in the case of a polynomial)

where $f(S)$ is some non-linear function of $S$, such as a polynomial, exponential, or logarithmic function. Then, we can use the estimated values of $f(S)$ and its parameters to calculate the partial derivative as:

$$\frac{\partial E(\sigma_{imp})}{\partial S} = f'(S)$$

where $f'(S)$ is the first derivative of $f(S)$ with respect to $S$.

Therefore in the case of a polynomial (2), 

$$f'(S) = \beta +2cS$$

Refer to the Part 2 of the Jupyter Notebook for the implementation.

## Part 3: Local Volatility addition


To prepare the data for the local volatility stripper, we need to have an implied volatility surface. This can be obtained from market data or simulated using a stochastic volatility model. Once we have the implied volatility surface, we can use the Dupire equation (which uses the Fokker-Planck equation) to compute the local volatility surface.

The Dupire equation is given by:

$$\frac{\partial C}{\partial T}=\frac{1}{2} \sigma^2 K^2 \frac{\partial^2 C}{\partial K^2}+\left(r_T-q_T\right)\left(C-K \frac{\partial C}{\partial K}\right)-r_T C$$
we can also express it in term of $\sigma(K,T)$ by:

$$\sigma(T, K)=\frac{1}{K} \sqrt{\frac{2 \partial C / \partial T(T, K)}{\partial^2 C / \partial x^2(T, K)}}$$

where $\sigma$ is the local volatility, $C$ is the call option price, $K$ is the strike price, $T$ is the time to maturity, and $r$ is the risk-free interest rate.

To compute the local volatility surface, we need to solve the Dupire equation for $\sigma(T,K)$ at each point on the implied volatility surface. This can be done numerically using finite differences or other numerical methods (left the derivation).

Once we have the local volatility surface, we can confirm the relationship between implied volatility and local volatility for a simplified volatility surface. The relationship is given by:

$$\sigma_{imp}(S,K) = \sigma_{loc}(S,K) * \sqrt{T}$$

where $\sigma_{imp}$ is the implied volatility, $\sigma_{loc}$ is the local volatility, $S$ is the spot price, $K$ is the strike price, and $T$ is the time to maturity.

For a simplified volatility surface where the local volatility is a function of the spot price only, we have:

$$\sigma_{imp}(S,K) = \sigma_{loc}(S) \sqrt{T}$$

where $\sigma_{loc}(S)$ is the local volatility as a function of the spot price.

The relationship between implied volatility and local volatility for this simplified surface is given by:

$$\sigma_{imp}(S,K) = \sigma_{loc}(S) + \frac{1}{2}(K-S) \frac{d\sigma_{loc}}{d S}$$

where $\frac{d\sigma_{loc}}{d S}$ is the derivative of the local volatility with respect to the spot price.

We can confirm this relationship by computing the implied volatility and local volatility for a range of spot and strike prices, and then computing the right-hand side of the equation and comparing it to the left-hand side. If the relationship holds, then we have validated the local volatility stripper.



<h1><center>References </center></h1>
*[1] Smile-lecture 6 and 7 - local Volatility*

*[2] Topic delta hedging dynamic hedging slides*

*[3] Optimal Delta Hedging for Options - Hull white*

*[4] Minimum Variance delta hedging -* [Minimum Variance Delta Hedging | FINCAD](https://fincad.com/blog/minimum-variance-delta-hedging)

*[5] Volatility Surfaces: Theory, Rules of Thumb, and Empirical Evidence by Toby Daglish, John Hull, and Wulin Suo -* https://www-2.rotman.utoronto.ca/~hull/DownloadablePublications/DaglishHullSuoRevised.pdf

*[6] Option-implied information: What’s the vol surface got to do with it? by - Maxim Ulrich and Simon Walther -* [Option-implied information: What’s the vol surface got to do with it? | Review of Derivatives Research (springer.com)](https://link.springer.com/article/10.1007/s11147-020-09166-0)

*[7] Equity Volatility Term Structures and the Cross Section of Option Returns by Aurelio Vasquez -* [Equity Volatility Term Structures and the Cross Section of Option Returns on JSTOR](https://www.jstor.org/stable/26590495)

*[8] Option Profit and Loss Attribution and Pricing: A New Framework by PETER CARR and LIUREN WU -* [Option Profit and Loss Attribution and Pricing: A New Framework (nyu.edu)](https://engineering.nyu.edu/sites/default/files/2020-09/option-profit-carr-jofi-12894.pdf)

*[9] Module 3 CQF and Advanced Volatility Modeling elective*

*[10] Python lab 6, 7, 8 on Monte Carlo Simulation, Finite Difference Methods, and Implied Volatility*